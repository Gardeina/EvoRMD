# EvoRMD: Interpretable Decoding of RNA Modifications via Evolutionary-aware Language Model and Uncertainty Calibration

**EvoRMD** is a deep learning framework for predicting multiple types of RNA modifications from primary RNA sequences.  
It leverages a large-scale pretrained RNA language model (*RNA-FM*), a trainable attention mechanism, and uncertainty calibration to achieve state-of-the-art performance across 11 RNA modification types.

---

## üöÄ Key Features

- Predicts **11 RNA modification types**:
  - **Am**, **Cm**, **Um**, **Gm**, **D**, **Œ® (Y)**, **m1A**, **m5C**, **m5U**, **m6A**, **m7G**
- Evolutionary-aware contextual embeddings from **RNA-FM**
- Trainable attention module highlighting informative sequence positions
- Category-specific uncertainty calibration
- Motif discovery and interpretability analysis

---

## üß© Prerequisites

- **Python**: 3.10.18
- **CUDA**: 12.8
- **PyTorch**: 2.3.1

> **Note:** Please ensure that your CUDA and PyTorch versions match your system's GPU drivers.

---

## üõ† Installation

1. **Clone this repository**

    ```bash
    git clone https://github.com/Gardeina/EvoRMD.git
    cd EvoRMD
    ```

2. **Create and activate a Python environment**

    ```bash
    conda create -n evormd python=3.10
    conda activate evormd
    ```

3. **Install dependencies**

    ```bash
    pip install -r requirements.txt
    ```

---

## üìÇ Usage

### 1Ô∏è‚É£ Data Preparation

If you need to train on a new dataset, place your dataset in the `RNAdata/` folder.

- Your data should consist of RNA sequences centered on the modification site, with **20 nt upstream and downstream** (total 41-nt windows).
- Process your data using the provided preprocessing script:

    ```bash
    python Script/preprocess_data.py
    ```

> All examples below `./RNAdata/11_motif_data.csv` and `./RNAdata/11_modif_preprocessed_data.pkl`.

---

### 2Ô∏è‚É£ Model Training

Use PyTorch's distributed launcher to train:

    ```bash
    torchrun --nproc_per_node=<num_gpus> main.py \
        --data ./RNAdata/11_modif_preprocessed_data.pkl \
        --label ./RNAdata/11_label_encoder.pkl \
        --result ./11_best_model_results.pkl \
        --model ./Model/11_best_model.pth
    ```

---
### 3Ô∏è‚É£ Calibration

The ‚Äú11_best_model_results.pkl‚Äù generated by ‚ÄúModel Training‚Äù in the previous step can be used as input, and the uncertainty calibrated results can be obtained by calibration.py. 

## ‚öôÔ∏è Arguments

- `--nproc_per_node`: Number of GPUs per node.
- `--data`: Path to the preprocessed data `.pkl` file.
- `--label`: Path to the saved label encoder `.pkl` file.
- `--result`: Path to the saved the results of model `.pkl` file.
- `--model`: Path to save the best model checkpoint.

---

## üß™ Example Output

After training, you will see logs showing metrics such as:

- Overall Accuracy, Precision, Recall, F1-Score, MCC
- Per-class Accuracy and metrics

Example:

```
Class m6A:
  Accuracy: 0.9854
  Precision: 0.9921
  Recall: 0.9783
  F1-score: 0.9851
  MCC: 0.9835
```
---

## üìù Citation

If you use **EvoRMD** in your research, please cite:

> 

---

## üì¨ Contact

For questions or issues, please open an issue on GitHub or contact:

- Bo Wang: 2300393032@email.szu.edu.cn
